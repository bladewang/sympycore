<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.4.1: http://docutils.sourceforge.net/" />
<title>Structure of SympyCore</title>
<meta name="author" content="Pearu Peterson" />
<style type="text/css">

/*
:Author: Pearu Peterson
:Contact: pearu.peterson AT gmail DOT com
:Copyright: This stylesheet has been placed in the public domain.

Stylesheet for use with Docutils.
*/

@import url(html4css1.css);

/* Your customizations go here.  For example: */

body {
    margin:0px;
    padding:25px;
    background-color: #ccc;
    font-size: 13px; font-family: arial, sans-serif;
    line-height:1.5em;
}

div.document {
    max-width: 700px;
    color: #000;
    background-color: #fff;
    padding:25px;
    border:5px solid #ddd;
}

div.sidebar {
  margin-left: 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

pre, tt {
  font-family: consolas, lucida console, courier new, monospace;
  color: #000080 ;
}

pre.literal-block, pre.doctest-block {
  line-height:1.3em;
  border-top:1px solid #ccc;
  border-bottom:1px solid #ccc;
  background-color:#f0f0f0;
  color: #000080 ;
}

</style>
</head>
<body>
<div class="document" id="structure-of-sympycore">
<h1 class="title">Structure of SympyCore</h1>
<table class="docinfo" frame="void" rules="none">
<col class="docinfo-name" />
<col class="docinfo-content" />
<tbody valign="top">
<tr><th class="docinfo-name">Author:</th>
<td>Pearu Peterson</td></tr>
<tr class="field"><th class="docinfo-name">Website:</th><td class="field-body"><a class="reference" href="http://sympycore.googlecode.com">http://sympycore.googlecode.com</a></td>
</tr>
<tr class="field"><th class="docinfo-name">Created:</th><td class="field-body">March 2008</td>
</tr>
</tbody>
</table>
<!-- -*- rest -*- -->
<div class="sidebar">
<p class="first sidebar-title">Table of contents</p>
<div class="contents local last topic">
<ul class="auto-toc simple">
<li><a class="reference" href="#basic-principles" id="id1" name="id1">1&nbsp;&nbsp;&nbsp;Basic principles</a></li>
<li><a class="reference" href="#implementation-of-principles" id="id2" name="id2">2&nbsp;&nbsp;&nbsp;Implementation of principles</a></li>
<li><a class="reference" href="#low-level-numbers" id="id3" name="id3">3&nbsp;&nbsp;&nbsp;Low-level numbers</a></li>
<li><a class="reference" href="#various-representations" id="id4" name="id4">4&nbsp;&nbsp;&nbsp;Various representations</a></li>
<li><a class="reference" href="#verbatim-algebra" id="id5" name="id5">5&nbsp;&nbsp;&nbsp;Verbatim algebra</a></li>
</ul>
</div>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id1" id="basic-principles" name="basic-principles">1&nbsp;&nbsp;&nbsp;Basic principles</a></h1>
<p>Any symbolic expression can be expressed as a pair of <em>expression
head</em> and <em>expression data</em>. The expression head contains information
how expression data should be interpreted.</p>
<p>To add a mathematical meaning to a symbolic expression, one needs to
specify to what <em>algebraic structure</em> possible values of a symbolic
expression belong to. The algebraic structure defines how symbolic
expressions are combined when used in an operation defined by the
given algebraic structure.</p>
<p>In the following we call algebraic structures as algebras for brevity.</p>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id2" id="implementation-of-principles" name="implementation-of-principles">2&nbsp;&nbsp;&nbsp;Implementation of principles</a></h1>
<p>In sympycore, a symbolic expression is defined as an instance of a
<tt class="docutils literal"><span class="pre">Expr</span></tt> class (the actual implementation of any code that follows
below may differ because of efficiency, here we just explain some
basic ideas):</p>
<pre class="literal-block">
class Expr(object):

    def __init__(self, head, data):
        self.pair = (head, data)
        self.head = head
        self.data = data
</pre>
<p>In a way, the <tt class="docutils literal"><span class="pre">Expr</span></tt> class represents an algebra with no
mathematical properties - it just holds some <em>head</em> and some <em>data</em>.</p>
<p>To define an algebra with additional features such as opertions
between its elements, a Python class is derived from the <tt class="docutils literal"><span class="pre">Expr</span></tt>
class:</p>
<blockquote>
<p>class AlgebraicStructure(Expr):</p>
<blockquote>
<dl class="docutils">
<dt>def operation(self, other):</dt>
<dd>...
return result</dd>
</dl>
</blockquote>
</blockquote>
<p>where the operation result is implemented in a method <tt class="docutils literal"><span class="pre">operation</span></tt>.</p>
<p>For example. a commutative ring element can be represented as an
instance of the following class:</p>
<pre class="literal-block">
class CommutativeRing(Expr):

     def __add__(self, other):
         return CommutativeRing('+', (self, other))

     __radd__ = __add__ # addition is commutative

     def __mul__(self, other):
         return CommutativeRing('*', (self, other))
</pre>
<p>For convenience, some additional methods can be provided to simplify
creating instances of the <tt class="docutils literal"><span class="pre">Expr</span></tt> based classes. For example, to
define a symbol of a commutative ring:</p>
<pre class="literal-block">
def Symbol(name):
    return CommutativeRing('S', name)
</pre>
<p>To define a number of a commutative ring:</p>
<pre class="literal-block">
def Number(value):
    return CommutativeRing('N', value)
</pre>
<p>To define an applied unary function with a value in a commutative
ring:</p>
<pre class="literal-block">
def F(x):
    &quot;Return the value of function F&quot;
    return &lt;result&gt;

def Apply(function, argument):
    return CommutativeRing(function, argument)
</pre>
<p>Since sympycore defines many classes representing different algebras,
the functions above are usually implemented as Python class methods of
the corresponding algebra classes. Also, the used <tt class="docutils literal"><span class="pre">head</span></tt> parts may
be changed to anything more appropiate.</p>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id3" id="low-level-numbers" name="low-level-numbers">3&nbsp;&nbsp;&nbsp;Low-level numbers</a></h1>
<p>Many algebras define numbers as generalized repetitions of the algebra
unit element. Sympycore uses and defines the following number types
for purely numerical task, i.e. both operands and operation results
are numbers):</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<tbody valign="top">
<tr><td>int, long</td>
<td>integers of arbitrary size</td>
</tr>
<tr><td>mpq</td>
<td>fractions</td>
</tr>
<tr><td>mpf</td>
<td>arbitrary precision floating point numbers</td>
</tr>
<tr><td>mpqc</td>
<td>complex numbers with rational parts</td>
</tr>
<tr><td>mpc</td>
<td>arbitrary precision complex floating point numbers</td>
</tr>
</tbody>
</table>
<p>Python <tt class="docutils literal"><span class="pre">float</span></tt> and <tt class="docutils literal"><span class="pre">complex</span></tt> instances are converted to <tt class="docutils literal"><span class="pre">mpf</span></tt>
and <tt class="docutils literal"><span class="pre">mpc</span></tt> instances, respectively.</p>
<p>These number types are called &quot;low-level&quot; numbers because some of
their properties may be unusual for generic numbers but these
properties are introduced to improve the efficiency of number
operations.</p>
<p>For example, <tt class="docutils literal"><span class="pre">mpq</span></tt> number is assumed to hold a normalized rational
number that is not integer.  Operation between <tt class="docutils literal"><span class="pre">mpq</span></tt> instances that
would produce integer result, will return <tt class="docutils literal"><span class="pre">int</span></tt> (or <tt class="docutils literal"><span class="pre">long</span></tt>)
instance. Similarly, the real valued result of an operation between
complex numbers <tt class="docutils literal"><span class="pre">mpqc</span></tt> (or <tt class="docutils literal"><span class="pre">mpc</span></tt>) will be an instance of <tt class="docutils literal"><span class="pre">int</span></tt>
or <tt class="docutils literal"><span class="pre">long</span></tt> or <tt class="docutils literal"><span class="pre">mpq</span></tt> (or <tt class="docutils literal"><span class="pre">mpf</span></tt>) type.</p>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id4" id="various-representations" name="various-representations">4&nbsp;&nbsp;&nbsp;Various representations</a></h1>
<p>Consider the following symbolic expression:</p>
<pre class="literal-block">
x**3 + 2*y
</pre>
<p>This expression may have at least three different representations:</p>
<pre class="literal-block">
Ring(head='ADD',   data=(x**3, 2*y))
Ring(head='TERMS', data=((x**3, 1), (y, 2)))
Ring(head=(x,y),   data=(((3,0), 1), ((0,1), 2)))
</pre>
<p>where the data structures are interpreted as follows:</p>
<pre class="literal-block">
(x**3) + (2*y)
(x**3) * 1 + y * 2
x**3 * y**0 * 1 + x**0 * y**1 * 2
</pre>
<p>respectively.</p>
<p>In general, there is no preferred representation for symbolic
expressions, each have their pros and cons depending on the tasks.</p>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id5" id="verbatim-algebra" name="verbatim-algebra">5&nbsp;&nbsp;&nbsp;Verbatim algebra</a></h1>
<p>Sympycore defines <tt class="docutils literal"><span class="pre">Verbatim</span></tt> class that represents verbatim algebra.
Verbatim algebra contains expressions in unevaluated form.</p>
</div>
</div>
</body>
</html>
